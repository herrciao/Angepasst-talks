---
import BaseLayout from '@/layouts/BaseLayout.astro';
import Breadcrumb from '@/components/Breadcrumb.astro';
---

<BaseLayout title="聯絡我">
  <Breadcrumb crumbs={[{ label: '聯絡我' }]} />

  <div class="max-w-xl">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">聯絡我</h1>
    <p class="text-gray-500 mb-8">有任何想法、問題或合作提案，都歡迎來信。</p>

    <!-- Formspree form — 把 YOUR_FORM_ID 換成你在 formspree.io 建立的 form ID -->
    <form
      action="https://formspree.io/f/YOUR_FORM_ID"
      method="POST"
      class="space-y-5"
      id="contact-form"
    >
      <div>
        <label for="name" class="block text-sm font-medium text-gray-700 mb-1">姓名</label>
        <input
          type="text"
          id="name"
          name="name"
          required
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent"
          placeholder="你的名字"
        />
      </div>

      <div>
        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
        <input
          type="email"
          id="email"
          name="email"
          required
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent"
          placeholder="your@email.com"
        />
      </div>

      <div>
        <label for="subject" class="block text-sm font-medium text-gray-700 mb-1">主旨</label>
        <input
          type="text"
          id="subject"
          name="subject"
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent"
          placeholder="這封信關於..."
        />
      </div>

      <div>
        <label for="message" class="block text-sm font-medium text-gray-700 mb-1">內容</label>
        <textarea
          id="message"
          name="message"
          rows="6"
          required
          class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-transparent resize-y"
          placeholder="想說的話..."
        ></textarea>
      </div>

      <button type="submit" class="btn-primary w-full justify-center py-2.5">
        送出
      </button>

      <div id="success-msg" class="hidden text-center p-4 bg-green-50 border border-green-200 rounded-md text-green-700 text-sm">
        已收到你的訊息，我會盡快回覆！
      </div>
    </form>
  </div>
</BaseLayout>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const successMsg = document.getElementById('success-msg');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = new FormData(form);
    try {
      const res = await fetch(form.action, {
        method: 'POST',
        body: data,
        headers: { Accept: 'application/json' },
      });
      if (res.ok) {
        form.reset();
        successMsg?.classList.remove('hidden');
      }
    } catch {}
  });
</script>
